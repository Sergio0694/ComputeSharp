<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0-windows10.0.22621.0</TargetFramework>
    <TargetPlatformMinVersion>10.0.17763.0</TargetPlatformMinVersion>
    <Platforms>x64;ARM64</Platforms>
    <RuntimeIdentifiers>win-x64;win-arm64</RuntimeIdentifiers>
    <WindowsSdkPackageVersion>10.0.22621.30-preview.aot18.ni-release-svc-prod3</WindowsSdkPackageVersion>
    <NoWarn>$(NoWarn);NU1603</NoWarn>
  </PropertyGroup>

  <PropertyGroup>

    <!--
      Disable IIDOptimizer, as it's causing a build error when the debug mode is set to embedded.
      This is only needed when generating projections anyway, and not in normal C# class libraries.
      See: https://github.com/microsoft/CsWinRT/issues/1478.
    -->
    <CsWinRTIIDOptimizerOptOut>true</CsWinRTIIDOptimizerOptOut>

    <!--
      Ignore some warnings about ambiguous cref attribute references. These are because the assembly defines
      blittable bindings for several ABI types from Win2D, in the same namespace as the ABI types from the
      CsWinRT projections that are in Win2D. They are internal, but Roslyn will still complain about them.
    -->
    <NoWarn>$(NoWarn);CS0419</NoWarn>

    <!-- Ignore warnings for usings outside of a namespace (needed for some WinRT type aliases) -->
    <NoWarn>$(NoWarn);IDE0065</NoWarn>
  </PropertyGroup>

  <ItemGroup>
    <Compile Include="..\ComputeSharp\Graphics\Interop\IReferenceTrackedObject.cs" Link="Interop\IReferenceTrackedObject.cs" />
    <Compile Include="..\ComputeSharp\Graphics\Interop\ReferenceTracker.cs" Link="Interop\ReferenceTracker.cs" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.Graphics.Win2D" Version="1.1.1-1.1.1-local6" />

    <!--
      We need the CsWinRT reference for the generator to kick in and generate all necessary supporting code
      to make the exposed types AOT compatible. Since we only need the generator, we can mark this as private.
    -->
    <PackageReference Include="Microsoft.Windows.CsWinRT" Version="2.1.0-prerelease-ci.240514.21" PrivateAssets="all" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\ComputeSharp.D2D1\ComputeSharp.D2D1.csproj" />
  </ItemGroup>
</Project>
